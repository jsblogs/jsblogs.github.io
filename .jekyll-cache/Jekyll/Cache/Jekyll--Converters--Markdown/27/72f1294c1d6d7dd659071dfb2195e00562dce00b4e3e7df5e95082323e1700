I"Q<p>Few days ago my colleague ask me about how Spring Dispatcher servlet gets registered in Java based config, as there is no XML
  used in configuration. One thing I was (actually we both were) sure about that the class <code class="highlighter-rouge">AbstractAnnotationConfigDispatcherServletInitializer</code>
  registers those servlet and all the configuration. But the question was How ?</p>

<p>In order to understand that we will be going back to the servlet world. According to 
<a href="https://docs.oracle.com/javaee/7/api/javax/servlet/ServletContainerInitializer.html?is-external=true" target="_blank">
Servlet Java Doc</a>, <code class="highlighter-rouge">ServletContainerInitializer</code> is the interface which is used to register servlets, filters and other related stuff.</p>

<p>So any implementation of <code class="highlighter-rouge">ServletContainerInitializer</code> will be notified of web application’s startup phase using a callback method</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kt">void</span> <span class="nf">onStartup</span><span class="o">(</span><span class="nc">Set</span><span class="o">&lt;</span><span class="nc">Class</span><span class="o">&lt;?&gt;&gt;</span> <span class="n">c</span><span class="o">,</span> <span class="nc">ServletContext</span> <span class="n">ctx</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">ServletException</span> <span class="o">{</span>
    
<span class="o">}</span> 
</code></pre></div></div>

<p>In above method, you’ll notice there is a parameter <strong>c</strong>  of type Set&lt;Class&lt;?&gt; &gt;. You probably thinking why it’s there.
So here is the another part of the magic, there is an annotation called <code class="highlighter-rouge">@HandlesTypes</code> used alongside with <code class="highlighter-rouge">ServletContainerInitializer</code>.
 The annotation accepts array of Class as input argument.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="nd">@interface</span> <span class="nc">HandlesTypes</span> <span class="o">{</span>
    
    <span class="nc">Class</span><span class="o">&lt;?&gt;[]</span> <span class="n">value</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div></div>

<p>So any class (and its subclasses), which is passed as an argument to that annotation (<code class="highlighter-rouge">HandlesTypes</code>) will be scanned by the container and finally the collection of those class will be passed to <code class="highlighter-rouge">ServletContainerInitializer#onStartup()</code> during the startup time.</p>

<p>Now you might be thinking, how the implementation of <code class="highlighter-rouge">ServletContainerInitializer</code> gets picked by the container? So the answer to that question is:</p>

<p>According to the <a href="https://docs.oracle.com/javaee/7/api/javax/servlet/ServletContainerInitializer.html?is-external=true" target="_blank">Java Docs</a></p>

<blockquote>
  <p>Implementations of this interface must be declared by a JAR file resource located inside the META-INF/services directory and named for the fully qualified class name of this interface, and will be discovered using the runtime’s service provider lookup mechanism or a container specific mechanism that is semantically equivalent to it. In either case, ServletContainerInitializer services from web fragment JAR files excluded from an absolute ordering must be ignored, and the order in which these services are discovered must follow the application’s classloading delegation model.</p>
</blockquote>

<p>Now come back to the Spring Era and check the spring-web*.jar (just extract the jar) and look for the file <strong>javax.servlet.ServletContainerInitializer</strong>. Inside that file you’ll find a fully qualified class name as <strong>org.springframework.web.SpringServletContainerInitializer</strong>.</p>

<p>That’s it, you’ve solved the mystery!!</p>

<p>Now check the source code of that class (go to the <a href="https://github.com/spring-projects/spring-framework/blob/master/spring-web/src/main/java/org/springframework/web/SpringServletContainerInitializer.java" target="_blank">GitHub</a>), you’ll notice 
 a class <code class="highlighter-rouge">WebApplicationInitializer</code> inside <code class="highlighter-rouge">@HandlesTypes</code> which is the parent class of most of the Spring’s initializers (<code class="highlighter-rouge">AbstractAnnotationConfigDispatcherServletInitializer</code>, <code class="highlighter-rouge">AbstractSecurityWebApplicationInitializer</code>).</p>

<p>Now you know how to create your own initializer.</p>

<p>Cheers!!! Happy coding.</p>

<p>Please share your thoughts, I’ve already have comment plugin for that ☺ ☺</p>

:ET