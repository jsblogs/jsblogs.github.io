I"¥<ul>
  <li><a href="#intro">Introduction</a></li>
  <li><a href="#tech-used">Technologies used</a></li>
  <li><a href="#app-events">Application Events</a></li>
  <li><a href="#app-runner">ApplicationRunner</a></li>
</ul>

<h2 id="introduction-">Introduction <a name="intro"></a></h2>
<p>Have you ever encountered a situation where youâ€™ve to perform some tasks immediately after the Spring/SpringBoot application starts.  i.e. 
Initialize some data into database, initialize application level constants, make an API call, etc.</p>

<p>There are several ways to achieve it. Here Iâ€™m gonna discuss about:</p>
<ol>
  <li>Application events</li>
  <li>ApplicationRunner</li>
</ol>

<h2 id="technologies-used-">Technologies used <a name="tech-used"></a></h2>
<ol>
  <li>Java 11</li>
  <li>Spring Boot 2.2.4</li>
  <li>Gradle 6.0.1</li>
</ol>

<h3 id="application-events-">Application events <a name="app-events"></a></h3>
<p>The Spring framework triggers various events. For our use case weâ€™ll be more interested in <code class="highlighter-rouge">ContextStartedEvent</code> and <code class="highlighter-rouge">ContextRefreshedEvent</code>.
<strong>ContextStartedEvent</strong> event triggered at the time of context gets started.
<strong>ContextRefreshedEvent</strong> event triggered at the time of context gets started or refreshed.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Component</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">EventHandler</span> <span class="o">{</span>
    <span class="nd">@EventListener</span><span class="o">(</span><span class="nc">ContextStartedEvent</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">handleContextStartEvent</span><span class="o">(</span><span class="nc">ContextStartedEvent</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// Write your code here</span>
    <span class="o">}</span>

    <span class="nd">@EventListener</span><span class="o">(</span><span class="nc">ContextRefreshedEvent</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">handleContextRefreshEvent</span><span class="o">(</span><span class="nc">ContextRefreshedEvent</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// Write your code here</span>
    <span class="o">}</span>
    <span class="c1">// Or you can handle both the events in 1 method  </span>
    
    <span class="nd">@EventListener</span><span class="o">({</span><span class="nc">ContextStartedEvent</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="nc">ContextRefreshedEvent</span><span class="o">.</span><span class="na">class</span><span class="o">})</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">handleBoth</span><span class="o">(</span><span class="nc">ApplicationContextEvent</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">e</span> <span class="k">instanceof</span> <span class="nc">ContextStartedEvent</span><span class="o">)</span> <span class="o">{</span>

        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>

        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="applicationrunner-">ApplicationRunner <a name="app-runner"></a></h3>
<p>SpringBoot provides an interface called <code class="highlighter-rouge">ApplicationRunner</code>, any bean implementing this interface should run when that contained in the <code class="highlighter-rouge">SpringApplication</code>.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Component</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">DBInitializer</span> <span class="kd">implements</span> <span class="nc">ApplicationRunner</span> <span class="o">{</span>
    
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">UserRepository</span> <span class="n">userRepository</span><span class="o">;</span>
    
    <span class="kd">private</span> <span class="nf">DBInitializer</span><span class="o">(</span><span class="nc">UserRepository</span> <span class="n">userRepository</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">userRepository</span> <span class="o">=</span> <span class="n">userRepository</span><span class="o">;</span>
    <span class="o">}</span>
    
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">(</span><span class="nc">ApplicationArguments</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
        <span class="c1">// Initialize user here</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>or the above can be used</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Configuration</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Config</span> <span class="o">{</span>
    
<span class="nd">@Bean</span>
    <span class="kd">public</span> <span class="nc">ApplicationRunner</span> <span class="nf">initializeUser</span><span class="o">(</span><span class="nc">UserRepository</span> <span class="n">userRepository</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">args</span> <span class="o">-&gt;</span> <span class="o">{</span>
            <span class="c1">// Initialize user here</span>
        <span class="o">};</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<p>ApplicationRunner provides <code class="highlighter-rouge">ApplicationArguments</code> in the run method which is used to get command line arguments by invoking <code class="highlighter-rouge">getSourceArgs()</code>.
You can also get the parsed arguments using this class. i.e.</p>

<p>Letâ€™s say youâ€™ve passed command line arguments like
<code class="highlighter-rouge">--source /usr/local --print-only --target /tmp/local</code></p>

<p>So the method call to</p>
<ol>
  <li><code class="highlighter-rouge">getOptionNames()</code> in <code class="highlighter-rouge">ApplicationArguments</code> will return set of arguments - [â€˜sourceâ€™, â€˜print-onlyâ€™, â€˜targetâ€™]</li>
  <li><code class="highlighter-rouge">containsOption(String name)</code> checks if argument contains</li>
  <li><code class="highlighter-rouge">getOptionValues(name)</code> returns list of option values. <code class="highlighter-rouge">getOptionValues('source')</code> will return list - [â€˜/usr/localâ€™]</li>
</ol>

:ET